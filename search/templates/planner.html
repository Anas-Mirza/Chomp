<h1>Planner</h1>

<form id="add-to-shopping-list-form">
    <input type="hidden" id="recipe-order" name="recipe-order" value="">
    <div class="row" id="id_recipe_list">
        <ul id="sortable-recipes" class="connected-list">
        {% for recipe in recipe_list %}
            <li id="{{recipe.id}}">
                <img src="{{recipe.lil_img}}"><br>
                <a href="/recipe/{{recipe.id}}/">{{ recipe.name }}</a>
            </li>


        {% endfor %}

        </ul>

        <ul id="sortable-planner" class="connected-list">
        {% for day in days %}
            <li id="{{day}}" class="ui-state-disabled"><h2>{{ day }}</h2><p></p></li>
            {% for recipe_day, recipes in saved_recipes.iteritems %}
                {% if day == recipe_day %}
                    {% for recipe in recipes %}
                        <li id="{{recipe.id}}">
                        <img src="{{recipe.lil_img}}"><br>
                        <a href="/recipe/{{recipe.id}}/">{{ recipe.name }}</a>
                        </li>
                    {% endfor %}
                {% endif %}
            {% endfor %}

        {% endfor %}
        </ul>

    <input type="submit" class="btn btn-default" value="Add to Shopping List">
    {% csrf_token %}
</form>

<script>

function addToShoppingList(evt) {
    evt.preventDefault();
    var params = $("#add-to-shopping-list-form").serialize();
    $("#content").load("shopping_list/", params 
    );
};

$("#add-to-shopping-list-form").on('submit', addToShoppingList);


$( init );

function init() {
    $('#sortable-recipes').sortable({
        connectWith: ".connected-list"
    });
}

$(function () {
    $( "#sortable-planner" ).sortable({ 
        cancel: ".ui-state-disabled",
        connectWith: ".connected-list",
        update: function(event, ui) {
            var order=$("#sortable-planner").sortable("toArray");
            $("#recipe-order").val(order.join());
        }
    });
});


</script>